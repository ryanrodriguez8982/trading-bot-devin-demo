# Issue #63: 2) [Risk] Portfolio & Position model (cash-only, spot, no leverage)

---

Summary
Introduce minimal portfolio state to track cash, per‑symbol position_size, avg_entry_price, and PnL. Enforce “only sell if you hold” (already true in sim) and no leverage. Overview

Implementation outline

New module: trading_bot/portfolio.py

class Portfolio: fields: cash: float, positions: dict[str, Position].

class Position: fields: symbol: str, qty: float, avg_entry: float, optional stop, take_profit.

Methods: buy(symbol, qty, price, fee_bps, slippage_bps), sell(...), equity(mark_to_market_price).

Replace ad‑hoc cash/qty handling in backtester with Portfolio.

Acceptance

Backtests reproduce current equity (within tolerance when fees/slippage=0).

Sells fail gracefully if qty==0.

Unit tests for buy/sell/mtm.

Background
Your sim already avoids selling unowned assets and leverage; formalize this in a reusable model. 